---
description: Git コミット作成をサポート - 変更内容の分析とコミットメッセージの提案
category: git
allowed-tools: Bash, Read, Grep, Glob
argument-hint: (引数なし = 現在の変更を分析してコミット) または コミット戦略を記述 (例: "修正のみコミット", "段階的にコミット")
---

# Claude コマンド: コミット支援

## 主な目的

Git コミットの作成をインテリジェントにサポートします。変更を分析し、適切なコミットメッセージを提案し、品質チェックを実行します。

## ユーザーの意図を理解する

ユーザーのリクエスト: $ARGUMENTS

引数が指定されていない場合、**現在のすべての変更を分析してコミット** します（最も一般的な使用例）。

それ以外の場合は、ユーザーの自然言語リクエストを解釈して、どのようにコミットを作成したいかを理解します。

## 実装アプローチ

### 1. 変更の分析

```bash
# 変更されたファイルを確認
git status --short

# 差分を確認
git diff --staged
git diff
```

### 2. コミットメッセージの提案

変更内容を分析し、以下の形式でコミットメッセージを提案:

```
<type>: <subject>

<body>

<footer>
```

#### Type の種類:
- `feat`: 新機能
- `fix`: バグ修正
- `docs`: ドキュメントのみの変更
- `style`: コードの意味に影響しない変更（フォーマットなど）
- `refactor`: バグ修正や機能追加ではないコードの変更
- `test`: テストの追加や修正
- `chore`: ビルドプロセスやツールの変更

### 3. 品質チェック（オプション）

プロジェクトにチェックコマンドがある場合:

```bash
# リント実行（存在する場合）
npm run lint 2>/dev/null || \
python -m ruff check . 2>/dev/null || \
echo "リントツールが見つかりません"

# テスト実行（存在する場合）
npm test 2>/dev/null || \
python -m pytest 2>/dev/null || \
echo "テストツールが見つかりません"
```

**注意**: チェックが失敗した場合、ユーザーに確認してからコミットを続行してください。

### 4. コミットの実行

```bash
# ステージングされていない変更を追加
git add -A

# コミット実行
git commit -m "<提案されたメッセージ>"
```

## コミット戦略

### 標準コミット（デフォルト）
すべての変更を1つのコミットにまとめます。

### 段階的コミット
関連する変更ごとに複数のコミットを作成:
```bash
# 特定のファイルのみステージング
git add <files>
git commit -m "<message>"
```

### 部分的コミット
特定のタイプの変更のみコミット:
```bash
# 例: ドキュメントの変更のみ
git add *.md
git commit -m "docs: ドキュメントを更新"
```

## レスポンスガイドライン

- 変更内容を簡潔に要約
- コミットメッセージの提案理由を説明
- チェックが失敗した場合は、ユーザーに確認を求める
- コミット後は次のステップ（push など）を提案

## レスポンスの例

**分析後:**
"3つのファイルに変更があります:
- src/auth.py: 認証ロジックの改善
- tests/test_auth.py: 新しいテストケースの追加
- README.md: セットアップ手順の更新

以下のコミットメッセージを提案します:
```
feat: 認証システムの改善とテストの追加

- 認証フローのエラーハンドリングを強化
- エッジケースのテストカバレッジを追加
- セットアップドキュメントを更新
```

このメッセージでコミットしてよろしいですか？"

**コミット後:**
"✅ コミットが成功しました！
次のステップ:
- `git push` でリモートにプッシュ
- プルリクエストの作成
- 他のブランチへのマージ"

## 覚えておくこと

あなたの役割は:
1. 変更を理解する
2. 適切なコミットメッセージを提案する
3. 必要に応じて品質チェックを実行
4. ユーザーを次のステップにガイドする

変更の「なぜ」を理解し、それをコミットメッセージに反映させることが重要です。
